(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-555766e8"],{"0560":function(e,t,n){"use strict";var a=n("88d4"),r=n("34cd").find,i=n("d421"),s="find",c=!0;s in[]&&Array(1)[s]((function(){c=!1})),a({target:"Array",proto:!0,forced:c},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),i(s)},"3ef3":function(e,t,n){"use strict";var a=n("88d4"),r=n("34cd").findIndex,i=n("d421"),s="findIndex",c=!0;s in[]&&Array(1)[s]((function(){c=!1})),a({target:"Array",proto:!0,forced:c},{findIndex:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),i(s)},"7b5a":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return u}));var a=n("ab00"),r=function(e){return Object(a["a"])({url:"/receiving/save",method:"POST",data:e})},i=function(e){return Object(a["a"])({url:"/receiving/update",method:"POST",data:e})},s=function(e){return Object(a["a"])({url:"/receiving/delete/"+e,method:"POST"})},c=function(e){return Object(a["a"])({url:"/receiving/info",params:{id:e}})},o=function(e){return Object(a["a"])({url:"/receiving/list",params:e})},l=function(e){return Object(a["a"])({url:"/receiving/finish",method:"POST",data:e})},u=function(e){return Object(a["a"])({url:"/receiving/collection",method:"POST",data:e})}},"993f":function(e,t,n){"use strict";var a=n("88d4"),r=n("8735"),i=n("1c34"),s=n("58db"),c=n("126a"),o=n("ac3c"),l=n("492f"),u=n("c40a"),d=n("3a6d"),f=d("splice"),h=r.TypeError,p=Math.max,m=Math.min,v=9007199254740991,b="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!f},{splice:function(e,t){var n,a,r,d,f,g,j=o(this),O=c(j),w=i(e,O),x=arguments.length;if(0===x?n=a=0:1===x?(n=0,a=O-w):(n=x-2,a=m(p(s(t),0),O-w)),O+n-a>v)throw h(b);for(r=l(j,a),d=0;d<a;d++)f=w+d,f in j&&u(r,d,j[f]);if(r.length=a,n<a){for(d=w;d<O-a;d++)f=d+a,g=d+n,f in j?j[g]=j[f]:delete j[g];for(d=O;d>O-a+n;d--)delete j[d-1]}else if(n>a)for(d=O-a;d>w;d--)f=d+a-1,g=d+n-1,f in j?j[g]=j[f]:delete j[g];for(d=0;d<n;d++)j[d+w]=arguments[d+2];return j.length=O-a+n,r}})},aad3:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("layout",{attrs:{title:"管理收货单"},on:{addEvent:e.addEvent}},[n("ul",{staticClass:"supplier-container has-header"},[n("li",{staticClass:"header"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.projectName,expression:"projectName"}],attrs:{type:"text",placeholder:"输入项目名称进行查询"},domProps:{value:e.projectName},on:{input:function(t){t.target.composing||(e.projectName=t.target.value)}}}),n("van-dropdown-menu",[n("van-dropdown-item",{attrs:{options:e.stateOption},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}})],1),n("i",{on:{click:function(t){return e.btnEvt("query")}}})],1),e._l(e.list,(function(t){return n("li",{key:t.id,staticClass:"swipe-cell-item"},[n("van-swipe-cell",{scopedSlots:e._u([{key:"left",fn:function(){return[n("van-button",{attrs:{square:"",type:"primary",text:"详情"},on:{click:function(n){return e.$router.push({path:"/receiving/detail",query:{id:t.id}})}}})]},proxy:!0},{key:"right",fn:function(){return[n("van-button",{directives:[{name:"show",rawName:"v-show",value:"新建"===t.state,expression:"it.state === '新建'"}],attrs:{square:"",type:"danger",text:"删除"},on:{click:function(n){return e.btnEvt("delete",t)}}}),n("van-button",{directives:[{name:"show",rawName:"v-show",value:"新建"===t.state,expression:"it.state === '新建'"}],attrs:{square:"",type:"warning",text:"编辑"},on:{click:function(n){return e.btnEvt("edit",t)}}}),n("van-button",{directives:[{name:"show",rawName:"v-show",value:"新建"===t.state,expression:"it.state === '新建'"}],attrs:{square:"",type:"primary",text:"完成"},on:{click:function(n){return e.btnEvt("approve",t)}}}),n("van-button",{directives:[{name:"show",rawName:"v-show",value:"完成"===t.state,expression:"it.state === '完成'"}],attrs:{square:"",type:"primary",text:"收款",color:"#7232dd"},on:{click:function(n){return e.btnEvt("approve",t)}}})]},proxy:!0}],null,!0)},[n("van-cell",[n("div",[e._v(e._s(t.projectName))]),n("span",[e._v("创建人："+e._s(t.userName))]),n("span",[e._v("创建日期："+e._s(e._f("dateFormat")(t.createTime,"yyyy-MM-dd")))]),n("span",{staticClass:"t"},[e._v("材料："+e._s(t.materialName)+" -- "+e._s(t.materialWeight)+" "+e._s(t.materialUnit))]),"作废"===t.state?n("i",{staticClass:"cancel-icon"}):e._e()])],1)],1)})),e.loading?n("li",{staticClass:"more"},[n("van-loading",{attrs:{color:"#1989fa"}}),e._v(" 数据加载中... ")],1):n("li",{staticClass:"more"},[e._v(" "+e._s(e.hasMore?"上滑加载更多数据":"没有更多数据")+" ")])],2),n("van-popup",{style:{height:"286px"},attrs:{position:"bottom","close-on-click-overlay":!1},model:{value:e.collectShow,callback:function(t){e.collectShow=t},expression:"collectShow"}},[n("div",{staticClass:"dialog-content"},[n("van-form",{ref:"collectForm"},[n("van-field",{attrs:{name:"收货单号",label:"收货单号",readonly:""},model:{value:e.collectObj.id,callback:function(t){e.$set(e.collectObj,"id",t)},expression:"collectObj.id"}}),n("van-field",{attrs:{name:"收款人",label:"收款人",readonly:""},model:{value:e.collectObj.userName,callback:function(t){e.$set(e.collectObj,"userName",t)},expression:"collectObj.userName"}}),n("van-field",{attrs:{name:"实收金额",label:"实收金额",placeholder:"请输入实收金额",rules:[{required:!0,message:"输入实收金额"}]},model:{value:e.collectObj.amount,callback:function(t){e.$set(e.collectObj,"amount",t)},expression:"collectObj.amount"}}),n("van-field",{attrs:{name:"备注",label:"备注",type:"textarea",placeholder:"请输入备注",rules:[{required:!0,message:"输入收款备注"}]},model:{value:e.collectObj.remark,callback:function(t){e.$set(e.collectObj,"remark",t)},expression:"collectObj.remark"}})],1),n("div",{staticClass:"btn"},[n("span",{on:{click:e.collectEvent}},[e._v("收款")]),n("span",{staticClass:"c",on:{click:function(t){e.collectShow=!1}}},[e._v("取消")])])],1)]),n("van-popup",{style:{height:"320px"},attrs:{position:"bottom","close-on-click-overlay":!1},model:{value:e.finishShow,callback:function(t){e.finishShow=t},expression:"finishShow"}},[n("div",{staticClass:"dialog-content"},[n("van-form",{ref:"finishNode"},[n("van-field",{attrs:{name:"处理单据",label:"处理单据",rules:[{required:!0,message:"输入处理单据"}],readonly:""},model:{value:e.finishObj.id,callback:function(t){e.$set(e.finishObj,"id",t)},expression:"finishObj.id"}}),n("van-field",{attrs:{name:"完成处理人",label:"完成处理人",rules:[{required:!0,message:"输入完成处理人"}],readonly:""},model:{value:e.finishObj.userName,callback:function(t){e.$set(e.finishObj,"userName",t)},expression:"finishObj.userName"}}),n("van-field",{attrs:{name:"实收数量",label:"实收数量",placeholder:"输入实收数量",rules:[{required:!0,message:"输入实收数量"}]},model:{value:e.finishObj.actualWeight,callback:function(t){e.$set(e.finishObj,"actualWeight",t)},expression:"finishObj.actualWeight"}}),n("van-field",{attrs:{name:"收货单价",label:"收货单价",placeholder:"输入收货单价",rules:[{required:!0,message:"输入收货单价"}]},model:{value:e.finishObj.salePrice,callback:function(t){e.$set(e.finishObj,"salePrice",t)},expression:"finishObj.salePrice"}}),n("van-field",{attrs:{name:"备注",label:"备注",type:"textarea",placeholder:"请输入备注",rules:[{required:!0,message:"输入支付备注"}]},model:{value:e.finishObj.remark,callback:function(t){e.$set(e.finishObj,"remark",t)},expression:"finishObj.remark"}})],1),n("div",{staticClass:"btn"},[n("span",{on:{click:e.finishEvent}},[e._v("完成")]),n("span",{staticClass:"c",on:{click:function(t){e.finishShow=!1}}},[e._v("取消")])])],1)])],1)},r=[],i=n("febe"),s=(n("e186"),n("b3d9"),n("10dd"),n("993f"),n("3ef3"),n("8ea3"),n("a6f5")),c=n("7b5a"),o=n("e5f2"),l={mixins:[o["a"]],extends:s["a"],data:function(){return{collectShow:!1,collectObj:{id:"",amount:"",userId:"",userName:"",remark:""},projectName:"",state:"",stateOption:[{text:"全部",value:""},{text:"新建",value:"新建"},{text:"完成",value:"完成"},{text:"作废",value:"作废"}],finishShow:!1,finishObj:{id:"",actualWeight:"",salePrice:"",userId:"",userName:"",remark:""}}},methods:{getList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(c["f"])({page:e.paging.page,size:e.paging.size,projectName:e.projectName,state:e.state});case 3:return n=t.sent,200===n.code?(e.list=1===e.paging.page?n.data.rows:e.list.concat(n.data?n.data.rows:[]),e.hasMore=!!n.data&&n.data.total>e.paging.page*e.paging.size):e.paging.page-=1,t.next=7,e.$nextTick();case 7:e.loading=!1;case 8:case"end":return t.stop()}}),t)})))()},addEvent:function(){this.handleRole("RECEIVING-01-01","C")&&this.$router.push("/receiving/edit")},editEvt:function(e){var t=e.id;this.handleRole("RECEIVING-01-01","U")&&this.$router.push({path:"/receiving/edit",query:{id:t}})},approveEvt:function(e){"新建"===e.state?(this.finishObj.id=e.id,this.finishObj.actualWeight=0,this.finishObj.salePrice=0,this.finishObj.userId=this.userInfo.id,this.finishObj.userName=this.userInfo.name,this.finishObj.remark="",this.finishShow=!0):(this.collectObj.id=e.id,this.collectObj.amount=0,this.collectObj.userId=this.userInfo.id,this.collectObj.userName=this.userInfo.name,this.collectObj.remark="",this.collectShow=!0)},deleteEvt:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.id,t.handleRole("RECEIVING-01-01","D")){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,Object(c["c"])(a);case 5:r=n.sent,200===r.code?(t.$toast.success("删除收货单成功"),t.list.splice(t.list.findIndex((function(e){return e.id===a})),1)):t.$toast.fail("删除收货单失败");case 7:case"end":return n.stop()}}),n)})))()},finishEvent:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.handleRole("RECEIVING-01-01","A")){t.next=2;break}return t.abrupt("return");case 2:e.$refs.finishNode.validate().then(Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["d"])(e.finishObj);case 2:n=t.sent,200===n.code?(e.$toast.success("完成收货单成功"),e.list=e.list.map((function(t){return t.id===e.finishObj.id&&(t.state="完成"),t})),e.finishShow=!1):e.$toast.fail("完成收货单失败");case 4:case"end":return t.stop()}}),t)})))).catch((function(){}));case 3:case"end":return t.stop()}}),t)})))()},collectEvent:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.handleRole("RECEIVING-01-01","A")){t.next=2;break}return t.abrupt("return");case 2:e.$refs.collectForm.validate().then(Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["b"])(e.collectObj);case 2:n=t.sent,200===n.code?(e.$toast.success("收货单【".concat(e.collectObj.id,"】收款成功")),e.collectShow=!1):e.$toast.fail("收款失败");case 4:case"end":return t.stop()}}),t)})))).catch((function(){}));case 3:case"end":return t.stop()}}),t)})))()}}},u=l,d=n("cba8"),f=Object(d["a"])(u,a,r,!1,null,null,null);t["default"]=f.exports},e5f2:function(e,t,n){"use strict";n("0560"),n("89a8"),n("2788"),n("aa08");var a={computed:{roles:function(){return this.$store.getters["common/getRoles"]}},methods:{handleRole:function(e,t){var n=this.roles.find((function(t){return t.id===e}));return!(!n||!n.role.includes(t))||(this.$toast.fail("你没有修改数据的权限"),!1)}}};t["a"]=a}}]);
//# sourceMappingURL=chunk-555766e8.13ef1173.js.map