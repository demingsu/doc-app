{"version":3,"sources":["webpack:///./src/views/purchase/index.vue?8301","webpack:///./node_modules/_@babel_runtime@7.17.2@@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack:///./node_modules/_@babel_runtime@7.17.2@@babel/runtime/helpers/esm/iterableToArray.js","webpack:///./node_modules/_@babel_runtime@7.17.2@@babel/runtime/helpers/esm/nonIterableSpread.js","webpack:///./node_modules/_@babel_runtime@7.17.2@@babel/runtime/helpers/esm/toConsumableArray.js","webpack:///src/views/purchase/index.vue","webpack:///./src/views/purchase/index.vue?8c73","webpack:///./src/views/purchase/index.vue","webpack:///./src/views/Auth.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","on","addEvent","staticClass","scorllEvt","directives","name","rawName","value","expression","domProps","$event","target","composing","projectName","stateOption","model","callback","$$v","state","btnEvt","_l","it","key","id","scopedSlots","_u","fn","$router","push","path","query","proxy","_v","_s","_e","createName","_f","createTime","materialName","materialWeight","materialUnit","hasMore","style","height","payShow","ref","payObj","$set","required","message","payEvent","approveShow","approveStep","approveObj","approveEvent","staticRenderFns","_arrayWithoutHoles","arr","Array","isArray","arrayLikeToArray","_iterableToArray","iter","Symbol","iterator","from","_nonIterableSpread","TypeError","_toConsumableArray","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","mixins","extends","data","text","amount","userId","userName","remark","isReject","created","methods","getList","purchaseListApi","page","size","result","code","editEvt","approveEvt","row","deleteEvt","purchaseDeleteApi","then","purchasePayApi","catch","purchaseFlowApi","purchaseInfoApi","newOrder","component","auth","computed","roles","$store","getters","handleRole","role","nr","find","oo","includes","$toast","fail"],"mappings":"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","file":"js/chunk-131e9c8c.4256831c.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('layout',{attrs:{\"title\":\"管理采购单\"},on:{\"addEvent\":_vm.addEvent}},[_c('ul',{staticClass:\"common-content-container has-header\",on:{\"scroll\":_vm.scorllEvt}},[_c('li',{staticClass:\"header\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.projectName),expression:\"projectName\"}],attrs:{\"type\":\"text\",\"placeholder\":\"输入项目名称进行查询\"},domProps:{\"value\":(_vm.projectName)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.projectName=$event.target.value}}}),_c('van-dropdown-menu',[_c('van-dropdown-item',{attrs:{\"options\":_vm.stateOption},model:{value:(_vm.state),callback:function ($$v) {_vm.state=$$v},expression:\"state\"}})],1),_c('i',{on:{\"click\":function($event){return _vm.btnEvt('query')}}})],1),_vm._l((_vm.list),function(it){return _c('li',{key:it.id,staticClass:\"swipe-cell-item\"},[_c('van-swipe-cell',{scopedSlots:_vm._u([{key:\"left\",fn:function(){return [_c('van-button',{attrs:{\"square\":\"\",\"type\":\"primary\",\"text\":\"详情\"},on:{\"click\":function($event){return _vm.$router.push({path: '/purchase/detail', query: {id: it.id}})}}})]},proxy:true},{key:\"right\",fn:function(){return [_c('van-button',{directives:[{name:\"show\",rawName:\"v-show\",value:(it.state === '新建'),expression:\"it.state === '新建'\"}],attrs:{\"square\":\"\",\"type\":\"danger\",\"text\":\"删除\"},on:{\"click\":function($event){return _vm.btnEvt('delete', it)}}}),_c('van-button',{directives:[{name:\"show\",rawName:\"v-show\",value:(it.state === '新建'),expression:\"it.state === '新建'\"}],attrs:{\"square\":\"\",\"type\":\"warning\",\"text\":\"编辑\"},on:{\"click\":function($event){return _vm.btnEvt('edit', it)}}}),_c('van-button',{directives:[{name:\"show\",rawName:\"v-show\",value:(it.state === '新建'),expression:\"it.state === '新建'\"}],attrs:{\"square\":\"\",\"type\":\"primary\",\"text\":\"确认\"},on:{\"click\":function($event){return _vm.btnEvt('approve', it)}}}),_c('van-button',{directives:[{name:\"show\",rawName:\"v-show\",value:(it.state === '确认'),expression:\"it.state === '确认'\"}],attrs:{\"square\":\"\",\"type\":\"primary\",\"text\":\"在途\"},on:{\"click\":function($event){return _vm.btnEvt('approve', it)}}}),_c('van-button',{directives:[{name:\"show\",rawName:\"v-show\",value:(it.state === '在途'),expression:\"it.state === '在途'\"}],attrs:{\"square\":\"\",\"type\":\"primary\",\"text\":\"完成\"},on:{\"click\":function($event){return _vm.btnEvt('approve', it)}}}),_c('van-button',{directives:[{name:\"show\",rawName:\"v-show\",value:(it.state === '完成'),expression:\"it.state === '完成'\"}],attrs:{\"square\":\"\",\"type\":\"primary\",\"text\":\"收款\",\"color\":\"#7232dd\"},on:{\"click\":function($event){return _vm.btnEvt('approve', it)}}})]},proxy:true}],null,true)},[_c('van-cell',[_c('div',[_vm._v(\" \"+_vm._s(it.projectName)+\" \"),(it.state !== '作废')?_c('em',{staticClass:\"state-text\"},[_vm._v(_vm._s(it.state))]):_vm._e()]),_c('span',[_vm._v(\"创建人：\"+_vm._s(it.createName))]),_c('span',[_vm._v(\"创建日期：\"+_vm._s(_vm._f(\"dateFormat\")(it.createTime,'yyyy-MM-dd')))]),_c('span',{staticClass:\"t\"},[_vm._v(\"材料：\"+_vm._s(it.materialName)+\" -- \"+_vm._s(it.materialWeight)+\" \"+_vm._s(it.materialUnit))]),(it.state === '作废')?_c('i',{staticClass:\"cancel-icon\"}):_vm._e()])],1)],1)}),(_vm.loading)?_c('li',{staticClass:\"more\"},[_c('van-loading',{attrs:{\"color\":\"#1989fa\"}}),_vm._v(\" 数据加载中... \")],1):_c('li',{staticClass:\"more\"},[_vm._v(\" \"+_vm._s(_vm.hasMore ? '上滑加载更多数据' : '没有更多数据')+\" \")])],2),_c('van-popup',{style:({ height: '286px' }),attrs:{\"position\":\"bottom\",\"close-on-click-overlay\":false},model:{value:(_vm.payShow),callback:function ($$v) {_vm.payShow=$$v},expression:\"payShow\"}},[_c('div',{staticClass:\"dialog-content\"},[_c('van-form',{ref:\"payForm\"},[_c('van-field',{attrs:{\"name\":\"支付人\",\"label\":\"支付人\",\"readonly\":\"\"},model:{value:(_vm.payObj.userName),callback:function ($$v) {_vm.$set(_vm.payObj, \"userName\", $$v)},expression:\"payObj.userName\"}}),_c('van-field',{attrs:{\"name\":\"支付金额\",\"label\":\"支付金额\",\"placeholder\":\"请输入支付金额\",\"type\":\"number\",\"rules\":[{required: true, message: '输入支付金额'}]},model:{value:(_vm.payObj.amount),callback:function ($$v) {_vm.$set(_vm.payObj, \"amount\", $$v)},expression:\"payObj.amount\"}}),_c('van-field',{attrs:{\"name\":\"备注\",\"label\":\"备注\",\"type\":\"textarea\",\"placeholder\":\"请输入备注\",\"rules\":[{required: true, message: '输入支付备注'}]},model:{value:(_vm.payObj.remark),callback:function ($$v) {_vm.$set(_vm.payObj, \"remark\", $$v)},expression:\"payObj.remark\"}})],1),_c('div',{staticClass:\"btn\"},[_c('span',{on:{\"click\":_vm.payEvent}},[_vm._v(\"支付\")]),_c('span',{staticClass:\"c\",on:{\"click\":function($event){_vm.payShow = false}}},[_vm._v(\"取消\")])])],1)]),_c('van-popup',{style:({ height: '320px' }),attrs:{\"position\":\"bottom\",\"close-on-click-overlay\":false},model:{value:(_vm.approveShow),callback:function ($$v) {_vm.approveShow=$$v},expression:\"approveShow\"}},[_c('div',{staticClass:\"dialog-content\"},[_c('van-steps',{attrs:{\"active\":_vm.approveStep,\"active-icon\":\"success\",\"active-color\":\"#fe5b02\"}},[_c('van-step',[_vm._v(\"新建\")]),_c('van-step',[_vm._v(\"确认\")]),_c('van-step',[_vm._v(\"在途\")]),_c('van-step',[_vm._v(\"完成\")])],1),_c('van-form',{ref:\"approveForm\"},[_c('van-field',{attrs:{\"label\":_vm.state === '新建' ? '审批人' : _vm.state === '确认' ? '在途处理人' : '完成处理人',\"readonly\":\"\"},model:{value:(_vm.approveObj.userName),callback:function ($$v) {_vm.$set(_vm.approveObj, \"userName\", $$v)},expression:\"approveObj.userName\"}}),_c('van-field',{attrs:{\"label\":\"处理意见\"},scopedSlots:_vm._u([{key:\"input\",fn:function(){return [_c('van-radio-group',{attrs:{\"direction\":\"horizontal\"},model:{value:(_vm.approveObj.isReject),callback:function ($$v) {_vm.$set(_vm.approveObj, \"isReject\", $$v)},expression:\"approveObj.isReject\"}},[_c('van-radio',{attrs:{\"name\":false}},[_vm._v(\"通过\")]),_c('van-radio',{attrs:{\"name\":true}},[_vm._v(\"驳回\")])],1)]},proxy:true}])}),_c('van-field',{attrs:{\"name\":\"备注\",\"label\":\"备注\",\"type\":\"textarea\",\"placeholder\":\"请输入备注\",\"rules\":[{required: true, message: '输入备注'}]},model:{value:(_vm.approveObj.remark),callback:function ($$v) {_vm.$set(_vm.approveObj, \"remark\", $$v)},expression:\"approveObj.remark\"}})],1),_c('div',{staticClass:\"btn\"},[_c('span',{on:{\"click\":_vm.approveEvent}},[_vm._v(\" \"+_vm._s(['审批', '在途', '开始验收'][_vm.approveStep - 1])+\" \")]),_c('span',{staticClass:\"c\",on:{\"click\":function($event){_vm.approveShow = false}}},[_vm._v(\"取消\")])])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","/************************************************\r\n * 根据每条数据的 state 来做页面的数据按钮控制\r\n * 新建状态 -- 删除、编辑、确认、详情\r\n * 确认状态 -- 在途、详情\r\n * 在途状态 -- 完成、详情\r\n * 完成状态 -- 收款、详情\r\n */\r\n\r\n<template>\r\n    <layout @addEvent=\"addEvent\" title=\"管理采购单\">\r\n        <ul @scroll=\"scorllEvt\" class=\"common-content-container has-header\">\r\n            <li class=\"header\">\r\n                <input type=\"text\" v-model=\"projectName\" placeholder=\"输入项目名称进行查询\">\r\n                <van-dropdown-menu>\r\n                    <van-dropdown-item v-model=\"state\" :options=\"stateOption\"/>\r\n                </van-dropdown-menu>\r\n                <i @click=\"btnEvt('query')\"></i>\r\n            </li>\r\n            <li class=\"swipe-cell-item\" v-for=\"it in list\" :key=\"it.id\">\r\n                <van-swipe-cell>\r\n                    <template #left>\r\n                        <van-button @click=\"$router.push({path: '/purchase/detail', query: {id: it.id}})\" square type=\"primary\" text=\"详情\" />\r\n                    </template>\r\n                    <van-cell>\r\n                        <div>\r\n                            {{it.projectName}}\r\n                            <em v-if=\"it.state !== '作废'\" class=\"state-text\">{{it.state}}</em>\r\n                        </div>\r\n                        <span>创建人：{{it.createName}}</span>\r\n                        <span>创建日期：{{it.createTime | dateFormat('yyyy-MM-dd')}}</span>\r\n                        <span class=\"t\">材料：{{it.materialName}} -- {{it.materialWeight}} {{it.materialUnit}}</span>\r\n                        <i v-if=\"it.state === '作废'\" class=\"cancel-icon\"></i>\r\n                    </van-cell>\r\n                    <template #right>\r\n                        <van-button @click=\"btnEvt('delete', it)\" v-show=\"it.state === '新建'\" square type=\"danger\" text=\"删除\"/>\r\n                        <van-button @click=\"btnEvt('edit', it)\" v-show=\"it.state === '新建'\" square type=\"warning\" text=\"编辑\"/>\r\n                        <van-button @click=\"btnEvt('approve', it)\" v-show=\"it.state === '新建'\" square type=\"primary\" text=\"确认\"/>\r\n                        <van-button @click=\"btnEvt('approve', it)\" v-show=\"it.state === '确认'\" square type=\"primary\" text=\"在途\"/>\r\n                        <van-button @click=\"btnEvt('approve', it)\" v-show=\"it.state === '在途'\" square type=\"primary\" text=\"完成\"/>\r\n                        <van-button @click=\"btnEvt('approve', it)\" v-show=\"it.state === '完成'\" square type=\"primary\" text=\"收款\" color=\"#7232dd\"/>\r\n                    </template>\r\n                </van-swipe-cell>\r\n            </li>\r\n            <li v-if=\"loading\" class=\"more\">\r\n                <van-loading color=\"#1989fa\" /> 数据加载中...\r\n            </li>\r\n            <li v-else class=\"more\">\r\n                {{hasMore ? '上滑加载更多数据' : '没有更多数据'}}\r\n            </li>\r\n        </ul>\r\n\r\n        <!-- 收款 -->\r\n        <van-popup v-model=\"payShow\"\r\n            position=\"bottom\"\r\n            :close-on-click-overlay=\"false\"\r\n            :style=\"{ height: '286px' }\">\r\n            <div class=\"dialog-content\">\r\n                <van-form ref=\"payForm\">\r\n                    <van-field v-model=\"payObj.userName\"\r\n                        name=\"支付人\"\r\n                        label=\"支付人\"\r\n                        readonly/>\r\n                    <van-field v-model=\"payObj.amount\"\r\n                        name=\"支付金额\"\r\n                        label=\"支付金额\"\r\n                        placeholder=\"请输入支付金额\"\r\n                        type=\"number\"\r\n                        :rules=\"[{required: true, message: '输入支付金额'}]\"/>\r\n                    <van-field v-model=\"payObj.remark\"\r\n                        name=\"备注\"\r\n                        label=\"备注\"\r\n                        type=\"textarea\"\r\n                        placeholder=\"请输入备注\"\r\n                        :rules=\"[{required: true, message: '输入支付备注'}]\"/>\r\n                </van-form>\r\n                <div class=\"btn\">\r\n                    <span @click=\"payEvent\">支付</span>\r\n                    <span @click=\"payShow = false\" class=\"c\">取消</span>\r\n                </div>\r\n            </div>\r\n        </van-popup>\r\n\r\n        <!-- 审批 -->\r\n        <van-popup v-model=\"approveShow\"\r\n            position=\"bottom\"\r\n            :close-on-click-overlay=\"false\"\r\n            :style=\"{ height: '320px' }\">\r\n            <div class=\"dialog-content\">\r\n                <van-steps :active=\"approveStep\" active-icon=\"success\" active-color=\"#fe5b02\">\r\n                    <van-step>新建</van-step>\r\n                    <van-step>确认</van-step>\r\n                    <van-step>在途</van-step>\r\n                    <van-step>完成</van-step>\r\n                </van-steps>\r\n                <van-form ref=\"approveForm\">\r\n                    <van-field v-model=\"approveObj.userName\"\r\n                        :label=\"state === '新建' ? '审批人' : state === '确认' ? '在途处理人' : '完成处理人'\"\r\n                        readonly/>\r\n                    <van-field label=\"处理意见\">\r\n                        <template #input>\r\n                            <van-radio-group v-model=\"approveObj.isReject\" direction=\"horizontal\">\r\n                                <van-radio :name=\"false\">通过</van-radio>\r\n                                <van-radio :name=\"true\">驳回</van-radio>\r\n                            </van-radio-group>\r\n                        </template>\r\n                    </van-field>\r\n                    <van-field v-model=\"approveObj.remark\"\r\n                        name=\"备注\"\r\n                        label=\"备注\"\r\n                        type=\"textarea\"\r\n                        placeholder=\"请输入备注\"\r\n                        :rules=\"[{required: true, message: '输入备注'}]\"/>\r\n                </van-form>\r\n                <div class=\"btn\">\r\n                    <span @click=\"approveEvent\">\r\n                        {{['审批', '在途', '开始验收'][approveStep - 1]}}\r\n                    </span>\r\n                    <span @click=\"approveShow = false\" class=\"c\">取消</span>\r\n                </div>\r\n            </div>\r\n        </van-popup>\r\n    </layout>\r\n</template>\r\n\r\n<script>\r\n    import ListHandle from '../common/ListHandle'\r\n    import { purchaseDeleteApi, purchaseFlowApi, purchaseInfoApi, purchaseListApi, purchasePayApi } from '../../apis/PurchaseApi'\r\n    import Auth from '../Auth'\r\n\r\n    export default {\r\n        mixins: [Auth],\r\n        extends: ListHandle,\r\n        data() {\r\n            return {\r\n                projectName: '',\r\n                state: '',\r\n                stateOption: [\r\n                    {text: '全部', value: ''},\r\n                    {text: '新建', value: '新建'},\r\n                    {text: '确认', value: '确认'},\r\n                    {text: '在途', value: '在途'},\r\n                    {text: '完成', value: '完成'},\r\n                    {text: '作废', value: '作废'}\r\n                ],\r\n                payShow: false,\r\n                payObj: {\r\n                    id: '',\r\n                    amount: '',\r\n                    userId: '',\r\n                    userName: '',\r\n                    remark: ''\r\n                },\r\n                approveShow: false,\r\n                approveStep: 0,\r\n                approveObj: {\r\n                    id: '',\r\n                    isReject: false,\r\n                    userId: '',\r\n                    userName: '',\r\n                    remark: ''\r\n                }\r\n            }\r\n        },\r\n        created() {\r\n            this.payObj.userId = this.userInfo.id\r\n            this.payObj.userName = this.userInfo.name\r\n            this.approveObj.userId = this.userInfo.id\r\n            this.approveObj.userName = this.userInfo.name\r\n        },\r\n        methods: {\r\n            async getList() {\r\n                this.loading = true\r\n                let result = await purchaseListApi({page: this.paging.page, size: this.paging.size, projectName: this.projectName, state: this.state})\r\n\r\n                if (result.code === 200) {\r\n                    this.list = this.paging.page === 1 ? result.data.rows : this.list.concat(!!result.data ? result.data.rows : [])\r\n                    this.hasMore = !!result.data ? (result.data.total > (this.paging.page * this.paging.size)) : false\r\n                } else {\r\n                    this.paging.page -= 1\r\n                }\r\n                await this.$nextTick()\r\n                this.loading = false\r\n            },\r\n            addEvent() {\r\n                if (!this.handleRole('PURCHASE-01-01', 'C')) return\r\n                this.$router.push('/purchase/edit')\r\n            },\r\n            editEvt(it) {\r\n                if (!this.handleRole('PURCHASE-01-01', 'U')) return\r\n                this.$router.push({path: '/purchase/edit', query: {id: it.id}})\r\n            },\r\n            approveEvt(row) {\r\n                switch (row.state) {\r\n                    case \"完成\":\r\n                        this.payObj.id = row.id\r\n                        this.payObj.amount = \"\"\r\n                        this.payObj.remark = \"\"\r\n                        this.payShow = true\r\n                        break\r\n                    default:\r\n                        this.approveStep = ['新建', '确认', '在途', '完成'].indexOf(row.state) + 1\r\n                        this.approveObj.id = row.id\r\n                        this.approveObj.isReject = false\r\n                        this.approveObj.remark = ''\r\n                        this.approveShow = true\r\n                        break\r\n                }\r\n            },\r\n            async deleteEvt(row) {\r\n                if (!this.handleRole('PURCHASE-01-01', 'D')) return\r\n                let result = await purchaseDeleteApi(row.id)\r\n                if (result.code === 200) {\r\n                    this.$toast.success('删除采购数据成功')\r\n                    this.list = this.list.map(it => {\r\n                        if (it.id === row.id) it.state = '作废'\r\n                        return it\r\n                    })\r\n                } else {\r\n                    this.$toast.fail('删除失败，请重试')\r\n                }\r\n            },\r\n            payEvent() {\r\n                if (!this.handleRole('PURCHASE-01-01', 'A')) return\r\n                this.$refs.payForm.validate()\r\n                    .then(async () => {\r\n                        let result = await purchasePayApi(this.payObj)\r\n                        if (result.code === 200) {\r\n                            this.$toast.success('采购付款成功')\r\n                            this.payShow = false\r\n                        } else {\r\n                            this.$toast.fail('采购付款失败，请重试')\r\n                        }\r\n                    }).catch(() => {})\r\n            },\r\n            approveEvent() {\r\n                if (!this.handleRole('PURCHASE-01-01', 'A')) return\r\n                this.$refs.approveForm.validate()\r\n                    .then(async () => {\r\n                        let result = await purchaseFlowApi(this.approveObj)\r\n                        if (result.code === 200) {\r\n                            this.$toast.success('采购订单审批成功')\r\n                            let newOrder = await purchaseInfoApi(this.approveObj.id)\r\n                            if (newOrder.code === 200) {\r\n                                this.list = [...this.list.map(it => {\r\n                                    if (it.id === this.approveObj.id) it.state = newOrder.data.state\r\n                                    return it\r\n                                })]\r\n                            }\r\n                            this.approveShow = false\r\n                        } else {\r\n                            this.$toast.fail('采购订单审批失败，请重试')\r\n                        }\r\n                    }).catch(() => {})\r\n            }\r\n        }\r\n    }\r\n</script>","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.3@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.3@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=768ba3fe&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","const auth = {\r\n    computed: {\r\n        roles() {\r\n            return this.$store.getters['common/getRoles']\r\n        }\r\n    },\r\n    methods: {\r\n        /**\r\n         * 校验角色权限\r\n         * @param {String} id 菜单id\r\n         * @param {String} role 角色权限：CRUDA\r\n         */\r\n        handleRole(id, role) {\r\n            let nr = this.roles.find(oo => oo.id === id)\r\n                if (!!nr && nr.role.includes(role)) {\r\n                    return true\r\n                } else {\r\n                    this.$toast.fail('你没有修改数据的权限')\r\n                    return false\r\n                }\r\n        }\r\n    }\r\n}\r\n\r\nexport default auth"],"sourceRoot":""}